= content_for :title do
  Detach Interface

= simple_form_for :fixed_ip, url: plugin('compute').remove_fixed_ip_instance_path(id: @instance.id), method: :put, remote: request.xhr?, html: {data: {modal: true}, class: 'form-horizontal', id: 'fixed_ip' }, wrapper: :horizontal_form do |f|
  %div{class: modal? ? 'modal-body' : ''}
    - if @errors
      %p.alert.alert-error
        = @errors

    - addresses = []
    - @instance.addresses.each do |network_name,ip_values|
      - ips = []
      - ip_values.each{|ip| ips << [ip["addr"],ip["addr"]] if ip["OS-EXT-IPS:type"]=='fixed' }
      - addresses << [network_name,ips] if ips.length>0
    = f.input :ip_address, {label: "Address",
      input_html:         {},
      as:                 :grouped_select,
      collection:         addresses,
      selected:           @ip_address,
      group_method:       :last,
      required:           true}

  %div.buttons{class: modal? ? 'modal-footer' : ''}
    - if modal?
      %button.btn.btn-default{type:"button", data: {dismiss:"modal"}, aria: {label: "Cancel"}} Cancel
    - else
      = link_to "Cancel", instances_url(), class: 'btn btn-default'
    = button_tag "Detach", { class: 'btn btn-primary pull-right', data: { disable_with: "Please wait..." } }
