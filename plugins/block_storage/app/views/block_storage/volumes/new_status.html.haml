= content_for :title do
  Reset Status

= simple_form_for :volume_status, url: plugin('block_storage').reset_status_volume_path(id: @volume.id), method: :post, remote: request.xhr?, html: {id: 'form_volume_status', data: {modal: true}, class: 'form-horizontal' }, wrapper: :horizontal_form  do |f|
  %div{class: modal? ? 'modal-body' : ''}

    = render partial: 'errors', locals: {data: @volume}

    %p
      = f.input :status,
        as: :select,
        collection: BlockStorage::Volume::STATUS,
        include_blank: false,
        selected: params.fetch(:volume_status,{}).fetch(:status, @volume.status)

      = f.input :attach_status,
        as: :select,
        collection: BlockStorage::Volume::ATTACH_STATUS,
        include_blank: false,
        selected: params.fetch(:volume_status,{}).fetch(:attach_status, (@volume.attached? ? 'attached' : 'detached') )

      = f.input :migration_status,
        as: :select,
        collection: BlockStorage::Volume::MIGRATION_STATUS,
        include_blank: true,
        selected: params.fetch(:volume_status,{}).fetch(:migration_status, (@volume.migrating? ? 'migrating' : nil) ),
        required: false

  %div.buttons{class: modal? ? 'modal-footer' : ''}
    - if modal?
      %button.btn.btn-default{type:"button", data: {dismiss:"modal"}, aria: {label: "Cancel"}} Cancel
    - else
      = link_to "Cancel", volumes_url(), class: 'btn btn-default'
    = button_tag "Reset", { class: 'btn btn-primary pull-right', data: { disable_with: "Please wait..." } }
